<!--index.wxml-->
<view style='  display: flex; flex-direction: column;'>

  <bindDialog showModalStatus="{{showModalStatus}}" openid="{{openIdInfo.openid}}" bind:bindEmployee="bindEmployee"> </bindDialog>
  <view class="menu">
    <image class="avatar" src="{{userInfo.avatarUrl.length > 0 ? userInfo.avatarUrl : '../images/avatar.png'}}" background-size="cover"></image>

    <button open-type="getUserInfo" class='avatar-btn' bindgetuserinfo='bindgetuserinfo'>
    </button>

    <view class="vertical-line line-left"></view>
    <image class="more" src="../images/more4.png" background-size="cover" bindtap='bindMoreEvent'></image>
    <view class="vertical-line line-right"></view>

    <input class='search' placeholder='搜索：系统版本/型号'></input>
  </view>

  <view class='page__bd_spacing ' style=' margin-top:100rpx;'>
    <view class='item-container'>
      <view class='item-base' bindtap='bindMyDevices'>
        <image class='item-logo' src='../images/my1.png'></image>
        <view style='margin-left:8px;'>我的设备</view> 
        <view class="weui-badge badge-position" hidden='{{myDevicesCount > 0 ? "" : "hidden"}}'>{{myDevicesCount}}</view>     
      </view>


      <view class='item-base'  bindtap='bindBorrowedDevices'>
        <image class='item-logo' src='../images/borrowed1.png'></image>
        <view style='margin-left:8px;'>借入设备</view>
        <view class="weui-badge badge-position" hidden='{{borrowedDevicesCount > 0 ? "" : "hidden"}}'>{{borrowedDevicesCount}}</view> 
      </view>
    </view>


    <view class="weui-cells__title title" >所有设备，共{{devices.length}}台</view>

    <view class='empty-base  {{ devices.length == 0 ? "empty-show" : "empty-hide"}}'>
      <image class='empty-image' src='../images/empty1.png'></image>
      <view class='empty-desc'>空空如也~ </view>
    </view>

    <block wx:for="{{devices}}" wx:key="id" wx:for-index="index">
      <view class="kind-list__item" bindtap='bindSpread' data-index="{{index}}">
        <view style='padding:8px; display: flex;flex-direction: row;justify-content: space-between; '>
          <view style='display: flex;flex-direction: column;width:100%;padding:10px;'>
            <view style='display: flex;flex-direction: row; '>
              <image src='../images/huawei.png' style='margin-top:6px; width:20px; height:20px; '></image>
              <view style='font-size:20px;margin-left:10px;'>{{item.deviceModel}}</view>

            </view>
            <view style='margin-top:8px;font-size:12px; display: flex;flex-direction: row;color:#666;'>
              <view class='label' style='width:70rpx;'>{{item.OSVersion}}</view>
              <view class='label'>{{item.deviceID}}</view>
              <view class='label'>{{item.employeeName}}</view>
            </view>
          </view>
          <view style='display: flex;flex-direction: row;vertical-align: middle;align-items: center;'>
            <view style='width:2rpx;height:80%;background:#eee;'></view>

            <view wx:if="{{item.status==-1}}">
              <view class='status-base status-borrowing'>申请中</view>
            </view>

            <view wx:elif="{{item.status==-2}}">
              <view class='status-base status-borrowed'>已借出</view>
            </view>
            <view wx:else>
              <view class='status-base status-normal'>闲置</view>
            </view>

          </view>





        </view>

        <view style='color:#666;margin:8px;padding:4px;font-size:12px;' hidden="{{hiddens[index] ? '' : 'hidden'}}">
          <view >设备型号：{{item.deviceModel}}</view>
          <view >设备品牌：{{brands[item.brandID]}}</view>
          <view >系统版本：{{item.OSVersion}}</view>
          <view >设备编号：{{item.deviceID}}</view>
          <view >公司编号：{{item.companyCode}}</view>
          <view >设备归属：{{item.employeeName}}</view>
          <view wx:if="{{item.status==-1}}">
            <view class='status-borrowing' style='padding:2px;'>申请人：{{item.borrowedEmployeeName}}</view>
          </view>
          <!-- <view>借取员工：</view> -->
          <button style='background-color:white;color:#333;margin-top:4px;' type="primary" catchtap="bindBorrowed" data-item="{{item}}" hidden='{{(item.status==0 || !item.status) ? "" : "hidden"}}'>申请借取</button>
        </view>
      </view>
    </block>
  </view>





</view>